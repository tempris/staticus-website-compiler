// 1:
// ```
//   ______ ___________          ___________ _______   _______ _____ _____   ______
//  / ____/ \___   ___/    /\    \___   ___/ \_   _/  / _____/ \   / \   /  / ____/
// / /          | |       /  \       | |       | |   / /        | |   | |  / /
// \ \___       | |      / /\ \      | |       | |   | |        | |   | |  \ \___
//  \___ \      | |     / /__\ \     | |       | |   | |        | |   | |   \___ \
//      \ \     | |    / ______ \    | |       | |   | |        | |   | |       \ \
//  ____/ /     | |   / /      \ \   | |      _| |_  \ \_____   \ \___/ /   ____/ /
// /_____/     /___\ /__\      /__\ /___\    /_____\  \______\   \_____/   /_____/

//  __      _____ ___ ___ ___ _____ ___      ___ ___  __  __ ___ ___ _    ___ ___
//  \ \    / / __| _ | __|_ _|_   _| __|    / __/ _ \|  \/  | _ \_ _| |  | __| _ \
//   \ \/\/ /| _|| _ \__ \| |  | | | _|    | |_| |_| | |\/| |  _/| || |__| _||   /
//    \_/\_/ |___|___/___/___| |_| |___|    \___\___/|_|  |_|_| |___|____|___|_|_\
// ```

// 2:
// ```
//   _________________        __________________  ____________ _____ ______
//  / ____/\___   ___/   /\   \___   ___/\_   _/ / _____/\   / \   // ____/
// / /         | |      /  \      | |      | |  / /       | |   | |/ /
// \ \___      | |     / /\ \     | |      | |  | |       | |   | |\ \___
//  \___ \     | |    / /__\ \    | |      | |  | |       | |   | | \___ \
//      \ \    | |   / ______ \   | |      | |  | |       | |   | |     \ \
//  ____/ /    | |  / /      \ \  | |     _| |_ \ \_____  \ \___/ / ____/ /
// /_____/    /___\/__\      /__\/___\   /_____\ \______\  \_____/ /_____/

//                  __      _____ ___ ___ ___ _____ ___
//                  \ \    / / __| _ | __|_ _|_   _| __|
//                   \ \/\/ /| _|| _ \__ \| |  | | | _|
//                    \_/\_/ |___|___/___/___| |_| |___|

//                   ___ ___  __  __ ___ ___ _    ___ ___
//                  / __/ _ \|  \/  | _ \_ _| |  | __| _ \
//                 | |_| |_| | |\/| |  _/| || |__| _||   /
//                  \___\___/|_|  |_|_| |___|____|___|_|_\
// ```

// 3:
// ```
//   ______________          ________________ __________ _____ _____
//  / ___/\__   __/    /\    \__   __/\_   _// ___/\   / \   // ___/
// / /       | |      /  \      | |     | | / /     | |   | |/ /
// \ \__     | |     / /\ \     | |     | | | |     | |   | |\ \__
//  \__ \    | |    / /__\ \    | |     | | | |     | |   | | \__ \
//     \ \   | |   / ______ \   | |     | | | |     | |   | |    \ \
//  ___/ /   | |  / /      \ \  | |    _| |_\ \___  \ \___/ / ___/ /
// /____/   /___\/__\      /__\/___\  /_____\\____\  \_____/ /____/

//               __      _____ ___ ___ ___ _____ ___
//               \ \    / / __| _ | __|_ _|_   _| __|
//                \ \/\/ /| _|| _ \__ \| |  | | | _|
//                 \_/\_/ |___|___/___/___| |_| |___|

//                ___ ___  __  __ ___ ___ _    ___ ___
//               / __/ _ \|  \/  | _ \_ _| |  | __| _ \
//              | |_| |_| | |\/| |  _/| || |__| _||   /
//               \___\___/|_|  |_|_| |___|____|___|_|_\
// ```

// 4:
// ```
//   ______________          _________________________ __________
//  / ___/\__   __/    /\    \__   __/\_   _/ ___/   / \   / ___/
// / /       | |      /  \      | |     | |/ /    | |   | | /
// \ \__     | |     / /\ \     | |     | | |     | |   | | \__
//  \__ \    | |    / /__\ \    | |     | | |     | |   | |\__ \
//     \ \   | |   / ______ \   | |     | | |     | |   | |   \ \
//  ___/ /   | |  / /      \ \  | |    _| |\ \___ \ \___/ /___/ /
// /____/   /___\/__\      /__\/___\  /_____\____\ \_____/_____/

//             __      _____ ___ ___ ___ _____ ___
//             \ \    / / __| _ | __|_ _|_   _| __|
//              \ \/\/ /| _|| _ \__ \| |  | | | _|
//               \_/\_/ |___|___/___/___| |_| |___|

//              ___ ___  __  __ ___ ___ _    ___ ___
//             / __/ _ \|  \/  | _ \_ _| |  | __| _ \
//            | |_| |_| | |\/| |  _/| || |__| _||   /
//             \___\___/|_|  |_|_| |___|____|___|_|_\
// ```

// 5:
// ```
//   _____________  _  _______________________ __________
//  / ___/__   __/ / \ \__   __/_   _/ ___/  / \   / ___/
// / /__    | |   / _ \   | |    | |/ /   | |   | | /__
// \___ \   | |  / /_\ \  | |    | | |    | |   | |\__ \
//     \ \  | | / _____ \ | |    | | |    | |   | |   \ \
//  ___/ /  | |/ /     \ \| |   _| |\ \___\ \___/ /___/ /
// /____/  /___\_\     /__\__\ /_____\_____\_____/_____/

//        __      _____ ___ ___ ___ _____ ___
//        \ \    / / __| _ | __|_ _|_   _| __|
//         \ \/\/ /| _|| _ \__ \| |  | | | _|
//          \_/\_/ |___|___/___/___| |_| |___|

//         ___ ___  __  __ ___ ___ _    ___ ___
//        / __/ _ \|  \/  | _ \_ _| |  | __| _ \
//       | |_| |_| | |\/| |  _/| || |__| _||   /
//        \___\___/|_|  |_|_| |___|____|___|_|_\
// ```

// 6:
// ```
//   _____________ _ _________________________________
//  / ___/__   __// \\__   __/_   _/ ___/  /\   / ___/
// / /___   | |  / _ \  | |    | |/ /   | |  | | /___
// \____ \  | | / /_\ \ | |    | | |    | |  | |\___ \
//  ___/ /  | |/ _____ \| |   _| |\ \___| \__/ |___/ /
// /____/  /___\_\   /__\__\ /_____\_____\____/_____/

//        __      _____ ___ ___ ___ _____ ___
//        \ \    / / __| _ | __|_ _|_   _| __|
//         \ \/\/ /| _|| _ \__ \| |  | | | _|
//          \_/\_/ |___|___/___/___| |_| |___|

//         ___ ___  __  __ ___ ___ _    ___ ___
//        / __/ _ \|  \/  | _ \_ _| |  | __| _ \
//       | |_| |_| | |\/| |  _/| || |__| _||   /
//        \___\___/|_|  |_|_| |___|____|___|_|_\
// ```

// 7:
// ```
//   ____________________________________________
//  / ___/_   __/ \__   __/_   _/ __/  /\   / __/
//  \___ \ | | / _ \ | |    | |/ /  | |  | |\__ \
//   __/ / | |/ ___ \| |   _| |\ \__| \__/ |__/ /
//  /___/ /___\_\ /__\__\ /_____\____\____/____/

//     __      _____ ___ ___ ___ _____ ___
//     \ \    / / __| _ | __|_ _|_   _| __|
//      \ \/\/ /| _|| _ \__ \| |  | | | _|
//       \_/\_/ |___|___/___/___| |_| |___|

//      ___ ___  __  __ ___ ___ _    ___ ___
//     / __/ _ \|  \/  | _ \_ _| |  | __| _ \
//    | |_| |_| | |\/| |  _/| || |__| _||   /
//     \___\___/|_|  |_|_| |___|____|___|_|_\
// ```

// const asciiArt = [
//   `
//   ______ ___________          ___________ _______   _______ _____ _____   ______
//  / ____/ \\___   ___/    /\\    \\___   ___/ \\_   _/  / _____/ \\   / \\   /  / ____/
// / /          | |       /  \\       | |       | |   / /        | |   | |  / /
// \\ \\___       | |      / /\\ \\      | |       | |   | |        | |   | |  \\ \\___
//  \\___ \\      | |     / /__\\ \\     | |       | |   | |        | |   | |   \\___ \\
//      \\ \\     | |    / ______ \\    | |       | |   | |        | |   | |       \\ \\
//  ____/ /     | |   / /      \\ \\   | |      _| |_  \\ \\_____   \\ \\___/ /   ____/ /
// /_____/     /___\\ /__\\      /__\\ /___\\    /_____\\  \\______\\   \\_____/   /_____/

//  __      _____ ___ ___ ___ _____ ___      ___ ___  __  __ ___ ___ _    ___ ___
//  \\ \\    / / __| _ | __|_ _|_   _| __|    / __/ _ \\|  \\/  | _ \\_ _| |  | __| _ \\
//   \\ \\/\\/ /| _|| _ \\__ \\| |  | | | _|    | |_| |_| | |\\/| |  _/| || |__| _||   /
//    \\_/\\_/ |___|___/___/___| |_| |___|    \\___\\___/|_|  |_|_| |___|____|___|_|_\\
//   `,

//   `
//   _________________        __________________  ____________ _____ ______
//  / ____/\\___   ___/   /\\   \\___   ___/\\_   _/ / _____/\\   / \\   // ____/
// / /         | |      /  \\      | |      | |  / /       | |   | |/ /
// \\ \\___      | |     / /\\ \\     | |      | |  | |       | |   | |\\ \\___
//  \\___ \\     | |    / /__\\ \\    | |      | |  | |       | |   | | \\___ \\
//      \\ \\    | |   / ______ \\   | |      | |  | |       | |   | |     \\ \\
//  ____/ /    | |  / /      \\ \\  | |     _| |_ \\ \\_____  \\ \\___/ / ____/ /
// /_____/    /___\\/__\\      /__\\/___\\   /_____\\ \\______\\  \\_____/ /_____/

//                  __      _____ ___ ___ ___ _____ ___
//                  \\ \\    / / __| _ | __|_ _|_   _| __|
//                   \\ \\/\\/ /| _|| _ \\__ \\| |  | | | _|
//                    \\_/\\_/ |___|___/___/___| |_| |___|

//                   ___ ___  __  __ ___ ___ _    ___ ___
//                  / __/ _ \\|  \\/  | _ \\_ _| |  | __| _ \\
//                 | |_| |_| | |\\/| |  _/| || |__| _||   /
//                  \\___\\___/|_|  |_|_| |___|____|___|_|_\\
//   `,

//   `
//   ______________          ________________ __________ _____ _____
//  / ___/\\__   __/    /\\    \\__   __/\\_   _// ___/\\   / \\   // ___/
// / /       | |      /  \\      | |     | | / /     | |   | |/ /
// \\ \\__     | |     / /\\ \\     | |     | | | |     | |   | |\\ \\__
//  \\__ \\    | |    / /__\\ \\    | |     | | | |     | |   | | \\__ \\
//     \\ \\   | |   / ______ \\   | |     | | | |     | |   | |    \\ \\
//  ___/ /   | |  / /      \\ \\  | |    _| |_\\ \\___  \\ \\___/ / ___/ /
// /____/   /___\\/__\\      /__\\/___\\  /_____\\\\____\\  \\_____/ /____/

//               __      _____ ___ ___ ___ _____ ___
//               \\ \\    / / __| _ | __|_ _|_   _| __|
//                \\ \\/\\/ /| _|| _ \\__ \\| |  | | | _|
//                 \\_/\\_/ |___|___/___/___| |_| |___|

//                ___ ___  __  __ ___ ___ _    ___ ___
//               / __/ _ \\|  \\/  | _ \\_ _| |  | __| _ \\
//              | |_| |_| | |\\/| |  _/| || |__| _||   /
//               \\___\\___/|_|  |_|_| |___|____|___|_|_\\
//   `,

//   `
//   ______________          _________________________ __________
//  / ___/\\__   __/    /\\    \\__   __/\\_   _/ ___/   / \\   / ___/
// / /       | |      /  \\      | |     | |/ /    | |   | | /
// \\ \\__     | |     / /\\ \\     | |     | | |     | |   | | \\__
//  \\__ \\    | |    / /__\\ \\    | |     | | |     | |   | |\\__ \\
//     \\ \\   | |   / ______ \\   | |     | | |     | |   | |   \\ \\
//  ___/ /   | |  / /      \\ \\  | |    _| |\\ \\___ \\ \\___/ /___/ /
// /____/   /___\\/__\\      /__\\/___\\  /_____\\____\\ \\_____/_____/

//             __      _____ ___ ___ ___ _____ ___
//             \\ \\    / / __| _ | __|_ _|_   _| __|
//              \\ \\/\\/ /| _|| _ \\__ \\| |  | | | _|
//               \\_/\\_/ |___|___/___/___| |_| |___|

//              ___ ___  __  __ ___ ___ _    ___ ___
//             / __/ _ \\|  \\/  | _ \\_ _| |  | __| _ \\
//            | |_| |_| | |\\/| |  _/| || |__| _||   /
//             \\___\\___/|_|  |_|_| |___|____|___|_|_\\
//   `,

//   `
//   _____________  _  _______________________ __________
//  / ___/__   __/ / \\ \\__   __/_   _/ ___/  / \\   / ___/
// / /__    | |   / _ \\   | |    | |/ /   | |   | | /__
// \\___ \\   | |  / /_\\ \\  | |    | | |    | |   | |\\__ \\
//     \\ \\  | | / _____ \\ | |    | | |    | |   | |   \\ \\
//  ___/ /  | |/ /     \\ \\| |   _| |\\ \\___\\ \\___/ /___/ /
// /____/  /___\\_\\     /__\\__\\ /_____\\_____\\_____/_____/

//        __      _____ ___ ___ ___ _____ ___
//        \\ \\    / / __| _ | __|_ _|_   _| __|
//         \\ \\/\\/ /| _|| _ \\__ \\| |  | | | _|
//          \\_/\\_/ |___|___/___/___| |_| |___|

//         ___ ___  __  __ ___ ___ _    ___ ___
//        / __/ _ \\|  \\/  | _ \\_ _| |  | __| _ \\
//       | |_| |_| | |\\/| |  _/| || |__| _||   /
//        \\___\\___/|_|  |_|_| |___|____|___|_|_\\
//   `,

//   `
//   _____________ _ _________________________________
//  / ___/__   __// \\\\__   __/_   _/ ___/  /\\   / ___/
// / /___   | |  / _ \\  | |    | |/ /   | |  | | /___
// \\____ \\  | | / /_\\ \\ | |    | | |    | |  | |\\___ \\
//  ___/ /  | |/ _____ \\| |   _| |\\ \\___| \\__/ |___/ /
// /____/  /___\\_\\   /__\\__\\ /_____\\_____\\____/_____/

//        __      _____ ___ ___ ___ _____ ___
//        \\ \\    / / __| _ | __|_ _|_   _| __|
//         \\ \\/\\/ /| _|| _ \\__ \\| |  | | | _|
//          \\_/\\_/ |___|___/___/___| |_| |___|

//         ___ ___  __  __ ___ ___ _    ___ ___
//        / __/ _ \\|  \\/  | _ \\_ _| |  | __| _ \\
//       | |_| |_| | |\\/| |  _/| || |__| _||   /
//        \\___\\___/|_|  |_|_| |___|____|___|_|_\\
//   `,

//   `
//  ____________________________________________
// / ___/_   __/ \\__   __/_   _/ __/  /\\   / __/
// \\___ \\ | | / _ \\ | |    | |/ /  | |  | |\\__ \\
//  __/ / | |/ ___ \\| |   _| |\\ \\__| \\__/ |__/ /
// /___/ /___\\_\\ /__\\__\\ /_____\\____\\____/____/

//     __      _____ ___ ___ ___ _____ ___
//     \\ \\    / / __| _ | __|_ _|_   _| __|
//      \\ \\/\\/ /| _|| _ \\__ \\| |  | | | _|
//       \\_/\\_/ |___|___/___/___| |_| |___|

//      ___ ___  __  __ ___ ___ _    ___ ___
//     / __/ _ \\|  \\/  | _ \\_ _| |  | __| _ \\
//    | |_| |_| | |\\/| |  _/| || |__| _||   /
//     \\___\\___/|_|  |_|_| |___|____|___|_|_\\
//   `,
// ];

const arts = [
`                   ▄▄██████▄▄
       ▄██████▀    ▀████████▀    ▀██████▄
       ██▀          ▀██████▀          ▀██
       ██            ▀████▀            ██
       █▀       ▄██▄        ▄██▄       ▀█
              ▄██████████████████▄
             ██████████████████████
             ██████████████████████
             ██████████████████████
             ██    ▀▀▀▀██▀▀▀▀    ██
             ██        ██        ██
             █████▄▄▄  ██  ▄▄▄█████
             ████████  ██  ████████
             ████████  ██  ████████
       █▄    ████████      ████████    ▄█
       ██    ▀███████      ███████▀    ██
       ██▄     ▀█████      █████▀     ▄██
       ▀██████▄  ▀███      ███▀  ▄██████▀
                   ▀█      █▀`,
`▄███▀ ▀████▀  █  ▀████▀ ▀██▀ ▄███▀ ▀██  ██▀ ▄███▀
██      ██   ███   ██    ██  ██     ██  ██  ██
▀███▄   ██  ██ ██  ██    ██  ██     ██  ██  ▀███▄
   ██   ██ ███████ ██    ██  ██     ██  ██     ██
▄███▀   ██ ██   ██ ██   ▄██▄ ▀███▄  ▀████▀  ▄███▀`,
`     █     █ █▀▀▀ █▀▀▄ ▄▀▀▀ ▀█▀ ▀▀█▀▀ █▀▀▀
     █ ▄▀▄ █ █▀▀▀ █▀▀▄  ▀▀▄  █    █   █▀▀▀
     ▀▄▀ ▀▄▀ █▄▄▄ █▄▄▀ ▄▄▄▀ ▄█▄   █   █▄▄▄`,
`   ▄▀▀▀ ▄▀▀▀▄ ▄▀▄ ▄▀▄ █▀▀▄ ▀█▀ █   █▀▀▀ █▀▀▄
   █    █   █ █ ▀▄▀ █ █▀▀   █  █   █▀▀▀ █▀▀▄
   ▀▄▄▄ ▀▄▄▄▀ █     █ █    ▄█▄ █▄▄ █▄▄▄ █  █`
];

const arts_small = [
`     █▀▀  ▀██▀  ▀▀█
     ▀  ▄█▄▄▄▄█▄  ▀
       ██████████
       █   ██   █
       ███ ██ ███
     ▄ ███    ███ ▄
     █▄▄▀█    █▀▄▄█`,
`Staticus Website Compiler`,
];

// // Function to calculate effective length of each line considering "\\" as 1 character
// function getEffectiveLength(line) {
//   return line.replace(/\\\\/g, ' ').length;
// }

// // Function to convert hex to ANSI 256 color code
// function hexToAnsi256(hex) {
//   const rgb = parseInt(hex, 16);
//   const r = (rgb >> 16) & 0xff;
//   const g = (rgb >> 8) & 0xff;
//   const b = rgb & 0xff;
//   return `\x1b[38;2;${r};${g};${b}m`;
// }

// Function to generate gradient colors
function generateGradient(startColor, endColor, steps) {
  const startRGB = {
    r: parseInt(startColor.slice(0, 2), 16),
    g: parseInt(startColor.slice(2, 4), 16),
    b: parseInt(startColor.slice(4, 6), 16)
  };

  const endRGB = {
    r: parseInt(endColor.slice(0, 2), 16),
    g: parseInt(endColor.slice(2, 4), 16),
    b: parseInt(endColor.slice(4, 6), 16)
  };

  const gradient = [];

  if (steps === 1) {
    const midRGB = {
      r: Math.round((startRGB.r + endRGB.r) / 2),
      g: Math.round((startRGB.g + endRGB.g) / 2),
      b: Math.round((startRGB.b + endRGB.b) / 2)
    };
    gradient.push(`\x1b[38;2;${midRGB.r};${midRGB.g};${midRGB.b}m`);
    return gradient;
  }

  for (let i = 0; i < steps; i++) {
    const r = Math.round(startRGB.r + (endRGB.r - startRGB.r) * (i / (steps - 1)));
    const g = Math.round(startRGB.g + (endRGB.g - startRGB.g) * (i / (steps - 1)));
    const b = Math.round(startRGB.b + (endRGB.b - startRGB.b) * (i / (steps - 1)));
    gradient.push(`\x1b[38;2;${r};${g};${b}m`);
  }

  return gradient;
}

const resetColor = "\x1b[0m";

async function getColors(forceColor256, lineCount = 1) {
  var supports256 = forceColor256;

  if (!forceColor256) {
    const supportsColor = await import('supports-color');
    const term = process.env.TERM || '';
    supports256 = /256color/.test(term) || supportsColor.default.stdout.has256;
  }

  const colors = [];

  if (supports256) {
    colors.push(...generateGradient("E5D300", "998000", lineCount));
  } else {
    const yellowAnsi = '\x1b[33m';
    for (let i = 0; i < lineCount; i++) {
      colors.push(yellowAnsi);
    }
  }

  return colors;
}

async function getArtString(forceColor256, art) {
  const noColor = process.env.NO_COLOR !== undefined && process.env.NO_COLOR !== '';

  if (noColor) {
    return art;
  }

  var supports256 = forceColor256;
  // console.log('forceColor256:', forceColor256);

  if (!forceColor256) {
    const supportsColor = await import('supports-color');
    const term = process.env.TERM || '';
    supports256 = /256color/.test(term) || supportsColor.default.stdout.has256;
  }

  // console.log('supports256:', supports256);

  const lines = art.split('\n');
  let result = "";

  if (supports256) {
    const gradientColors = generateGradient("E5D300", "998000", lines.length);
    lines.forEach((line, index) => {
      result += `${gradientColors[index]}${line}${resetColor}\n`;
    });
  } else {
    result = `\x1b[33m${art}${resetColor}\n`;
  }

  return result.trimEnd();
}

async function getIntroString(forceColor256 = false, small = false) {
  // const width = process.stdout.columns || 0;
  // let bestFit = asciiArt[asciiArt.length - 1];
  // const lines = bestFit.split('\n');
  // const maxLineLength = Math.max(...lines.map(getEffectiveLength));

  // if (maxLineLength > width) {
  //   bestFit = "Staticus Website Compiler";
  // }

  const newline = small ? "" : "\n";
  let finalOutput = "\n" + newline;
  const currentArts = small ? arts_small : arts;

  for (let i = 0; i < currentArts.length; i++) {
    finalOutput += await getArtString(forceColor256, currentArts[i]) + "\n" + newline;

    // Add a new line between art pieces, but avoid adding it after the last one
    if (i < currentArts.length - 1) {
      finalOutput += "\n";
    }
  }

  return finalOutput;
}

module.exports = { getIntroString, getColors };
